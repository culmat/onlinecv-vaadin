# Vaadin UI for the Online CV

The Online CV is a showcase to show the combination of different technologies like jersey rest, jaxb, mongo db, vaadin and jongo(http://jongo.org).

This project contains only the UI part that accesses the online CV rest services.
The rest services are implemented here : (https://github.com/beisdog/onlinecv.git). Please read the documentation there.

## Noteworthy Architecture Design Decisions of the UI Project
### Domain Object Generation from Xsd File
The UI project generates the domain objects for the Online CV from a schema file that was provided by the [rest services project](https://github.com/beisdog/onlinecv). The java generator from xsd is invoked from the maven pom.xml

You can get the xsd by calling the rest service ["/rest/onlinecv/xsd"](http://localhost:8888/rest/onlinecv/xsd).
## Dynamic UI
The UI is very generic and introspects the domain object and annotations to actually build the forms and tables.

Because some customization is needed you can pass options and generation features to the dynamic UI.
In this way you can add just new properties or objects in the domain layer and they will magically appear in the UI.

The implementation details can be found in the following places:

* [com.beisert.onlinecv.vaadin.OnlineCVUI](/src/main/java/com/beisert/onlinecv/vaadin/OnlineCVUI.java)
In the method `init(VaadinRequest)` you can find how the generic UI is customized.

Method: `init(VaadinRequest)`
```java
this.cfg = new GenericBeanFormConfig();
cfg.givePropertyHint(OnlineCV.class, "projects", Project.class);
cfg.givePropertyHint(OnlineCV.class, "userSkills", UserSkill.class);
cfg.givePropertyHint(OnlineCV.class, "jobs", Job.class);
cfg.givePropertyHint(OnlineCV.class, "education", Education.class);
cfg.givePropertyHint(OnlineCV.class, "certifications", Certification.class);
cfg.givePropertyHint(OnlineCV.class, "languageSkills", LanguageSkill.class);
cfg.givePropertyHint(PersonalData.class, "communicationData", CommunicationData.class);
cfg.givePropertyHint(Project.class, "additionalInfos", GenericContainer.class);
cfg.givePropertyHint(Project.class, "usedSkills", UserSkill.class);
cfg.givePropertyHint(GenericContainer.class, "children", GenericContainer.class);
cfg.givePropertyHint(I18NText.class, "languageTexts", LanguageText.class);
cfg.setPropertyCaption(OnlineCV.class, "name", "CV Name");
cfg.setShownPropertiesInList(Project.class, "from", "to", "title", "customer", "key");
cfg.setPropertyEditor(SimpleDate.class, SimpleDateEditor.class);
cfg.setPropertyEditor(I18NText.class, I18NTextEditor.class);
cfg.setTableColumnConverter(I18NText.class, I18NTableColumnConverter.class);
cfg.setTableColumnConverter(SimpleDate.class, SimpleDateTableColumnConverter.class);
cfg.setTableColumnConverter(int.class, PlainIntegerConverter.class);
cfg.setFormFieldConverter(int.class, PlainIntegerConverter.class);
cfg.setTableColumnConverter(Integer.class, PlainIntegerConverter.class);
cfg.setFormFieldConverter(Integer.class, PlainIntegerConverter.class);

```
###Explanation:

* `GenericBeanFormConfig.givePropertyHint` when a java bean property is of type java.util.List there is no way to find out which type is contained in the List, because java erases that information at runtime. This method informs the generic UI about the parameterized type of the List of the property.
* `GenericBeanFormConfig.setPropertyCaption` gives the property a new caption. Otherwise the caption is generated by converting the java camel case to a human friendly format.
* `GenericBeanFormConfig.setShownPropertiesInList` specifies the columns that are displayed for in the table.
* `GenericBeanFormConfig.setTableColumnConverter`specifies a type converter to convert property value of bean to a string.
* `GenericBeanFormConfig.setFormFieldConverter` does the same for a property displayed in a form.
* `GenericBeanFormConfig.setPropertyEditor` registers a custom class to generate a UI for property type.

In the method `initEditor()` the GenericBeanForm is initialized.
 
### Package `com.beisert.onlinecv.vaadin.generic`
* `GenericBeanForm` : generates a form and adds recursively subforms for the given java bean. It iterates through the properties of the bean via reflection.
* `GenericBeanTable`: generates a table for a bean property of type list. Clicking on a row open the list item in a new `GenericBeanForm`
* `GenericBeanEnumComboBox`: generates a dropdown for a property of type enum.
* `PlainIntegerConverter`: A simple formatter used to display integer values.
* `GenericBeanFormConfig`: Customization object to influence the UI generation. Explained in the previous section.

# Getting it to run
* before you can run the UI you must install and run the Rest server part: 
 * described here: http://github.com/beisdog/onlinecv 
* checkout the git repository on your local machine: 
 * `git clone http://github.com/beisdog/onlinecv-vaadin.git`
* run maven:
	* `cd onlinecv-vaadin`
	* `mvn clean install jetty:run`
* open your browser on: http://localhost:8080

# Debugging
To debug set these MAVEN_OPTS in your console:

`export MAVEN_OPTS -Xdebug -Xnoagent -Djava.compiler=NONE -Xrunjdwp:transport=dt_socket,address=8000,server=y,suspend=n`

Then in your eclipse create a new Remote Debugging configuration and connect to port 8000.

# Technologies involved
The following technologies are shown:
* Vaadin
* Java 8
* Jersey Rest client
* a self developed framework to quickly generate UIs
* Jaxb Java class  generation from schema file according to rest layer.

# Roadmap
* PDF Generation
* Picture upload
* Security
* Generation of template files (Vaadin design files) that can be modified by the User to adjust the UIs without coding.
